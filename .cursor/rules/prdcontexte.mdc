Pr√©-requis techniques et DSI ‚Äî OperaFlow
üéØ Objectif de cette section

D√©finir les exigences techniques, les contraintes d‚Äôinfrastructure et les pr√©-requis d‚Äôint√©gration n√©cessaires au d√©ploiement et √† l‚Äôexploitation d‚ÄôOperaFlow, afin d‚Äôassurer :

la conformit√© avec les politiques IT internes,

la s√©curit√© des donn√©es (RGPD, RLS, authentification),

la p√©rennit√© du d√©ploiement (maintenance, mont√©e de version),

et la compatibilit√© avec les syst√®mes existants (SIRH, Microsoft 365, messagerie).

üß± 1. Architecture globale
√âl√©ment	Fournisseur / Stack	R√¥le
Front-end	Next.js 15 (h√©berg√© sur Vercel)	Interface web et mobile OperaFlow (PWA installable)
Back-end	Supabase (PostgreSQL + Auth + Storage + Edge Functions)	Base de donn√©es, s√©curit√©, stockage, automatisations
Envoi de mails	SendGrid (API SMTP)	Notifications et workflows (demande d‚Äôacc√®s, visa, alerte)
Authentification	Supabase Auth (JWT) + possibilit√© OAuth2 Microsoft	Gestion des utilisateurs et permissions
H√©bergement	Vercel (.app / HTTPS auto)	D√©ploiement continu, CDN, versioning
Connecteurs externes	Microsoft 365, SIRH interne	Absences, Outlook, synchronisation RH
üîê 2. S√©curit√© et conformit√©
2.1 Authentification & permissions

Authentification par Supabase Auth (email / mot de passe / OAuth Microsoft).

Jeton JWT s√©curis√©, stock√© dans cookie HTTP-Only.

Politique de mot de passe configurable.

Gestion centralis√©e des r√¥les et pages en base (tbl_roles, tbl_role_pages).

Contr√¥le d‚Äôacc√®s RLS Supabase :
chaque requ√™te SQL est filtr√©e selon l‚Äôidentit√© de l‚Äôutilisateur connect√©.

2.2 Chiffrement et communication

Toutes les communications se font en HTTPS / TLS 1.3.

Donn√©es chiffr√©es au repos (PostgreSQL + Storage Supabase).

Aucun acc√®s direct √† la base n‚Äôest expos√© en clair.

Les cl√©s sensibles (SERVICE_ROLE_KEY, SENDGRID_API_KEY) sont stock√©es dans Vercel, non visibles c√¥t√© client.

2.3 Conformit√© RGPD

Donn√©es h√©berg√©es en Europe (Supabase EU-Central).

Tra√ßabilit√© des connexions et actions critiques.

Droit √† l‚Äôoubli et suppression utilisateur automatis√©e.

Conservation des documents dosim√©triques et l√©gaux 5 ans max.

‚òÅÔ∏è 3. H√©bergement et d√©ploiement
3.1 Vercel

H√©bergement manag√© pour Next.js (front OperaFlow).

Domaines personnalis√©s (https://operaflow.app ou sous-domaine interne).

HTTPS automatique et CDN mondial.

D√©ploiement CI/CD GitHub :

chaque branche = environnement ‚Äúpreview‚Äù

branche main = production

Environnements :

Production : instance stable pour les utilisateurs

Preview : test de nouvelles fonctions

D√©veloppement : instance priv√©e pour int√©gration Cursor

3.2 Supabase

H√©bergement base PostgreSQL manag√©e.

Fonctionnalit√©s activ√©es :

Auth (comptes, s√©curit√© JWT)

Storage (documents, PDF sign√©s)

RLS (filtrage par r√¥le)

Edge Functions (envois automatiques, synchronisation SIRH)

Sauvegardes automatiques quotidiennes.

Tableau de bord web pour gestion de la base (Supabase Studio).

üóùÔ∏è 4. Variables d‚Äôenvironnement requises (Vercel)

√Ä configurer avant le premier d√©ploiement :

Variable	Description
NEXT_PUBLIC_SUPABASE_URL	URL de l‚Äôinstance Supabase
NEXT_PUBLIC_SUPABASE_ANON_KEY	Cl√© publique du client Supabase
SUPABASE_SERVICE_ROLE_KEY	Cl√© serveur s√©curis√©e (admin base)
NEXTAUTH_SECRET	Cl√© de chiffrement des sessions
SENDGRID_API_KEY	Cl√© API SendGrid (notifications)
SUPABASE_STORAGE_BUCKET	Nom du bucket documents RH / Affaires
SUPABASE_FUNCTION_URL	(optionnel) URL des Edge Functions
APP_BASE_URL	URL publique de l‚Äôapplication (https://operaflow.app)
üîÅ 5. Int√©grations et synchronisations
Source	Type	M√©thode
SIRH interne	Import collaborateurs, absences, formations	Via Edge Function Supabase planifi√©e (cron)
Microsoft Outlook / 365	Absences / disponibilit√©s / r√©unions	Webhooks ou API Graph
SendGrid	Notifications (demande acc√®s, visa client, alerte RH)	API REST
Power BI (option)	Lecture KPI agr√©g√©s	API REST Supabase / vue SQL view_kpi_global
‚öôÔ∏è 6. Pr√©-requis techniques DSI
√âl√©ment	Sp√©cification minimale
Navigateur utilisateur	Chrome / Edge / Firefox / Safari (version ‚â•2022)
R√©seau	Acc√®s HTTPS vers *.vercel.app et *.supabase.co
Infrastructure interne	Aucun serveur local requis
Authentification Microsoft (option)	Azure AD / Entra ID compatible OAuth2
Compte SendGrid	Acc√®s API cl√© (niveau ‚ÄúFull Access‚Äù)
Politique IT interne	Autoriser installation PWA (.app) sur poste
Sauvegarde / Export	Acc√®s admin Supabase Studio pour dump SQL mensuel
Supervision	Monitoring natif Supabase + logs Vercel (gratuits)
üß© 7. Administration & maintenance

L‚Äôapplication OperaFlow est enti√®rement administrable depuis l‚Äôinterface :

R√¥les et droits par page

Activation / d√©sactivation de fonctionnalit√©s (feature flags)

Suivi des utilisateurs et journaux d‚Äôacc√®s

Les op√©rations techniques (sauvegarde, d√©ploiement, logs) sont automatis√©es via Supabase & Vercel.

Aucune d√©pendance serveur physique, VM ou VPN.
Les mises √† jour se font par push GitHub ‚Üí build Vercel.

üîÆ 8. Scalabilit√© et perspectives

Architecture stateless : mont√©e en charge native via Vercel (CDN) et Supabase (scaling horizontal PostgreSQL).

Compatible multi-site / multi-entit√© via la gestion dynamique des r√¥les et p√©rim√®tres.

Extensible vers :

Power BI (reporting corporate),

Microsoft Teams (alertes),

Signature qualifi√©e eIDAS (v2),

IA pr√©dictive (v3).

üß≠ 9. Phrase de synth√®se technique

OperaFlow repose sur une architecture serverless, s√©curis√©e et manag√©e, associant Next.js (front) d√©ploy√© sur Vercel et Supabase (back) pour les donn√©es, l‚Äôauthentification et le stockage.
Cette combinaison garantit :

une mise en production rapide,

une s√©curit√© conforme RGPD,

un co√ªt de maintenance r√©duit,

et une scalabilit√© imm√©diate pour accompagner la croissance du nombre de sites et d‚Äôutilisateurs.---
alwaysApply: true
---
